class: middle center

# Lua 101

## We have to start somewhere!

---

# Running the interpretor

- Lua source usually in `source.lua` files
- From the command line: `lua source.lua` (or `lua.exe source.lua` on Windows, depending on the installation)
- From a menu (or shortcut) in a Lua-friendly text editor

- one program = one Lua file (for now)
- interpreter reads the whole file and executes it (a "chunck")

---

# Before we really start

Comments: ignored by the interpretor

```lua
-- till the end of line
--[[till the closing brackets]]
--[==[till the closing matched brackets]==]
```

The `print` function: basic way to output (can take any type as argument)

```lua
print(5 + 6)            -- output: 11
print("This is great!") -- output: This is great!
```

Assignment to a variable (details to come)

```lua
a = 6
print(a)    -- output: 6
```

---

# Basic types and literals

- *type*: a way to interpret data

Number

```lua
4     0.4     4.57e-3     0.3e12     5e+20     0xabcd1234
```

Internally: double precision floating point numbers

- integers from 0 to 2^53
- real numbers from 4.9 * 10^-324 to 1.79 * 10^308, with ~17 significant digits
- infinity
- NaN ("not a number")
- negative versions of all of these

---

# Basic types and literals (2)

String: a sequence of characters representing text

```lua
'blah blah'     -- single quoted
"blah blah"     -- double quoted
[[blah blah]]   -- long string

"This is a singly quoted word: 'horse'"
'Bob said: "Hi, I am Bob!"'
[[Bob said: "Hi, I'm Bob!"]]
```

Escapes: `\t` (tab), `\n` (new line), `\\`, `\'`, `\"`, `\[`,`\]`.

Long string doesn't escape anything and allows newlines.

---

# Basic types and literals (3)

Boolean: represents a truth value

- `true`
- `false`

Used in logic and to make branching decisions (what part of the code to execute).

```lua
print(5 > 10)   -- false
```

---

# Basic types and literals (4)

Nil: absence of value

```lua
print(a)    -- nil
a = 5
print(a)    -- 5
a = nil
print(a)    --- nil
```

Any unused variable "contains" `nil`. We can use it explicitely to "forget" data.

---

# Basic types and literals (5)

The `type` function returns the type of its argument as a string:

```lua
print(type(5))        -- number
print(type("foo"))    -- string
print(type(a))        -- nil
a = true
print(type(a))        -- boolean
```

A variable doesn't have a type. Only its current value has. Lua is a *dynamically typed* language.

---

# Expressions

An expression is anything that has a value. Basic expressions are:

- variables
- literals

Expressions are built by combining smaller expressions with *operators*:

- binary (connects two expressions): `expression operator expression`
- unary (tranforms one expression into another): `operator expression`

Expressions can be grouped in parentheses when the meaning is ambiguous: `(expression)`

---

# Expressions (2)

Arithmetic operators operate on numbers:

```lua
a = 5 + 6       -- addition
b = 4 - a       -- substraction
c = b * b       -- multiplication
print(c / 2)    -- division
d = -c          -- (unary) negation
```

Other arithmetic operators:

```lua
print(2^10)     -- 1024 (exponentiation)
print(5 % 2)    -- 1 (remainder of division)
```

---

# Expressions (3)

We can nest expressions as much as wanted:

```lua
b = 1e3
a = 5 + 4 * 2 - ((7 + b) / 15)
print(a)    -- -54.133333333333
```

Operators `*` and `/` have *precedence* over `+` and `-` (like in math): `a * b + c` is `(a * b) + c`. Unary negation has precedence over all others: `- a * - b` is `(-a) * (-b)`. When in doubt: parentheses!

---

# Expressions (4)

Relational operators *compare* things, and return booleans ("is this true or not?")

Order:

- `a < b`: is a strictly smaller than b?
- `a > b`: is a strictly greater than b?
- `a <= b`: is a smaller or equal to b?
- `a >= b`: is a greater or equal to b?

Works for numbers (natural order), and strings (lexicographic order).

```lua
print(5 < 10)           -- true
print("art" <= "music") -- true
print(5 >= "music")     -- error: attempt to
                        -- compare string with number
```

---

# Expressions (5)

Equality:

- `a == b`: is `a` equal to `b`?
- `a ~= b`: is `a` different than `b`?

Works for any types. Two values of different types will always be different, though.

```lua
print(5 == 2.5 * 2)            -- true
print(5 == "5")                -- false
print(type("meh") == "string") -- true
print((5 < 10) == true)        -- true
print(foo ~= nil)              -- false
```

Note: `==` is the comparison operator, `=` is for assignment.

---

# Expressions (6)

Logical operators: operate on booleans.

- `a and b` is true is both `a` and `b` are true
- `a or b` is true if either `a` or `b` is true, or both
- `not a` is true if `a` is false, and vice versa

```lua
x = 5
print(x >= 0 and x <= 10)   -- is x between 0 and 10 included?
print(x % 2 == 0)           -- is x an even number?
```

Note that, among other things:

```lua
a ~= b == not(a == b)
a <= b == a < b or a == b
a <= b == not(a > b)
not(not a) == a
```

---

# Expressions (7)

String operators:

- `a .. b`: concatenation (`a` followed by `b`)
- `#a`: length (number of characters in `a`)

```lua
foo = "This is" .. " great!"
foo = foo .. " Isn't it?"
print(foo)                  -- This is great! Isn't it?
print(#foo)                 -- 24
print(#"")                  -- 0
print(foo .. "" == foo)     -- true
```

---

# Expressions (8)

Precedence table for all operators (from low precendence to high precedence):

    or
    and
    <     >     <=    >=    ~=    ==
    ..
    +     -
    *     /     %
    not   #     - (unary)
    ^

All binary operators left-associative: `a ? b ? c ? d == (((a ? b) ? c) ? d`, except `..` and `^` which are right associative:

```lua
print(2^3^2)    -- 512
print((2^3)^2)  -- 64
```

When in doubt: parentheses!